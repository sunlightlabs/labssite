{% extends "base_blog.html" %}
{% load blog %}
{% load comments %}
{% load markup %}

{% block sidebar %}
    <div id="blogArchive">
    	<h3>More Posts</h3>
        {% recent_posts 3 %}
    </div>
{% endblock %}

{% block blog_content %}
    <div class="entryMetadata">
    	<h3 class="entry_title"><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h3>
    	<div class="commentsMetaData">
    		<span class="type">Comments:</span>
    		<span class="value">
    			<a href="{{ post.get_absolute_url }}#comments">{{ post.comment_count }}</a>
    		</span>
    	</div>
		<div class="hr"><hr /></div>
    	<div class="authorMetaData vcard">
    		<span class="type">Written by </span>
    		<span class="value fnn">{{ post.author.first_name }}</span>
    	</div>
    	<div class="updatedMetaData">
    		<span class="type">Date:</span>
    		<span class="value">{{ post.date_published|date:"F j Y" }}</span>
    	</div>
    </div>
    <div class="post_content">
        {% ifequal post.markup 'markdown' %}
            {{ post.content|markdown|safe }}
        {% else %}
            {% ifequal post.markup 'textile' %}
                {{ post.content|textile|safe }}
            {% else %}                
                {% ifequal post.markup 'restructuredtext' %}
                    {{ post.content|restructuredtext|safe }}
                {% else %}
                    {{ post.content|safe }}
                {% endifequal %}
            {% endifequal %}
        {% endifequal %}
    </div>
    {% get_comment_list for post as comment_list %}
    <div id="comments">
        <h3>Comments</h3>
        {% if comment_list %}
            <ol>
                {% for comment in comment_list %}
                    <li>
                        {% if comment.user_url %}
                            <p><a href="{{ comment.user_url }}">{{ comment.user_name }}</a></p>
                        {% else %}
                            <p>{{ comment.user_name }}</p>
                        {% endif %}
                        <p>{{ comment.comment }}</p>
                    </li>
                {% endfor %}
            </ol>
        {% endif %}
        {% render_comment_form for post %}
    </div>
{% endblock %}