{% extends "ideas/base.html" %}
{% load tagging_tags %}
{% load newsfeed_tags %}

{% block content %}
<div id="projects" class="module">

    {% ifequal project.lead user %}
    <div id="projectDetail_header" class="contentHeader">
        <h2 class="projects">{{project.name}}</h2>
        <a class="projectEdit" href="{% url edit_project project.slug %}">edit project</a>
        <div class="clear"></div>
    </div>
    {% else %}
    <div class="contentHeader">
        <h2 class="projects">{{project.name}}</h2>
    </div>
    {% endifequal %}

    <div id="projectDetail" class="module">
        <dl class="entryMetadata">
            {% if project.official %}
            <dt>This project is funded by</dt>
            <dd><a class="seperationBlock" class="seperationBlock" href="http://sunlightfoundation.com">Sunlight</a></dd>
            {% endif %}

            <dt>Became a project on</dt>
            <dd>{{project.creation_date|date}}</dd>

            {% if project.idea %}
            <dt>Project began as an implementation of idea</dt>
            <dd>"<a href="{{project.idea.get_absolute_url}}">{{project.idea}}</a>"</dd>
            {% endif %}

        </dl>
        <div id="project_mainDetails">
            <div id="projectDescription">{{project.description}}</div>
            <ul>
                {% for link in project.links.all %}
                <li class="{{link.get_link_type_display}}_link">
                    <a title="{{link.get_link_type_display}}" href="{{link.url}}">{{link.name}}</a>
                </li>
                {% endfor %}
            </ul>
        </div>

        {% tags_for_object project as tags %}
        <div id="languages">
            <h3 id="skillsHeader">Tags</h3>
            <ul>
                {% for tag in tags %}
                <li><a href="{% url projects_tagged tag %}">{{tag}}</a></li>
                {% endfor %}
            </ul>
        </div>

        {# TODO: change if feed can be populated from non-subscription sources #}
        {% if project.subscriptions.count %}
        <div id="timeline">
            <h3>News</h3>
            <ul id="projectTimeline" class="leftTimeline">
                {% render_feed project.slug 10 %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block sidebar %}
<h3 class="space">Project Participants</h3>
<div class="module">
    <h4>Lead</h4>
    <a id="leadParticipant" href="{{project.lead.get_absolute_url}}">
        <img src="{{project.lead.profile.photo|default:"/media/images/avatar_male.jpg"}}" />
        <span id="leadName">{{project.lead.username}}</span>
        <span id="metadata">Sunlight Labs</span>
    </a>
    <div class="clear"></div>

    {% with project.get_members as members %}
    {% if members %}
    <h4 id="teamHeader">Team</h4>
    <ul id="teamParticipants">
        {% for member in members %}
            {% if not member.role.lead %}
            <li>
                <a href="{{member.get_absolute_url}}"><img src="{{member.profile.photo|default:"/media/images/avatar_male.jpg"}}"/>
                    <span>{{member}}</span>
                </a>
            </li>
            {% endif %}
        {% endfor %}
        <div class="clear"></div>
    </ul>
    {% endif %}
    {% endwith %}
</div>

<hr></hr>
<h3 class="space">Want To Join This Project?</h3>
<div id="projectJoin" class="module">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam dapibus lorem a nibh consectetur eu porttitor massa semper. Pellentesque hendrerit, eros vitae molestie ultrices. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    <a href="{% url join_project project.slug %}">
    <button class="joinBtn">
        <span>Join</span>
    </button>
    </a>
</div>
<div class="clear"></div>
{% endblock %}
