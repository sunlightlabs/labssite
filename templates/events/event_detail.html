{% extends "events/base.html" %}
{% load blog %}
{% load people %}

{% block title %}{{block.super}} - {{event}}{% endblock title %}

{% block content %}
<div class="module vevent">
    <div id="eventDetail_Title" class="contentHeader">
        <h2 class="summary">{{event}}</h2>
    </div>
    <div id="eventDetails" class="module">
        <dl class="eventAuthorMetadata">
            <dt>This event was added by</dt>
            <dd><a href="{{event.creator.get_absolute_url}}">{% display_name event.creator %}</a></dd>
        </dl>    
        <div id="eventMetaData">
            <dl>
                <dt>Start Date:</dt>
                <dd>
                    <abbr class="dtstart" title="{{ event.start_date.isoformat }}">
                        {{ event.start_date|date}}
                    </abbr>
                </dd>

                <dt>End Date:</dt>
                <dd>
                    <abbr class="dtend" title="{{ event.end_date.isoformat }}">
                        {{ event.end_date|date}}
                    </abbr>
                </dd>
                <div class="clear"></div>

                <dt class="eventLocation">Location:</dt>
                <dd class="location eventLocation">{{ event.location }}</dd>

                <dt>URL:</dt>
                <dd class="url">{{ event.url|urlize }}</dd>
            </dl>
            <div class="clear"></div>
        </div>
        <span class="description">{{ event.description }}</span>
        
        {% with event.attendances.all as attendances %}
        {% if attendances or user.is_authenticated %}
        <div id="attend_event">
            {% if attendances %}
            <h3 id="attendeesTitle">Attendees</h3>
            <ul id="attendeeList">
                {% for att in attendances %}
                <li>
                    <dl>
                        <dt>Photo</dt>
                        <dd>{% gravatar att.user.email %}</dd>

                        <dt>Name of Attendee</dt>
                        <dd>{% display_name att.user %}</dd>
                
                        <dt>Number of Guests</dt>
                        <dd id="eventGuests">+{{att.guests}}</dd>
                
                        <dt>Attendees Message</dt>
                        <dd id="eventMessage">{{att.message}}</dd>
                    </dl>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
            {% if user.is_authenticated %}
            <h3>I'm Interested</h3>
            <form id="joinProjectForm" method="POST" action=".">
                <ul>
                    {{ form.as_ul }}
                    <button type="submit" class="signupBtn">
                        <span>Sign Up</span>
                    </button>
                </ul>
            </form>
            {% endif %}
        </div>
        {% endif %}
        {% endwith %}
    </div>
</div>
{% endblock %}
